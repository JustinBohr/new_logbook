<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <!-- Le styles -->
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/bootstrap-responsive.css" type="text/css"/>
        <link rel="stylesheet" href="css/style.css" type="text/css"/>

         <style type="text/css">
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>

        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
          <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <title>Olog Logbook</title>
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap-transition.js"></script>
        <script src="js/bootstrap-alert.js"></script>
        <script src="js/bootstrap-modal.js"></script>
        <script src="js/bootstrap-dropdown.js"></script>
        <script src="js/bootstrap-scrollspy.js"></script>
        <script src="js/bootstrap-tab.js"></script>
        <script src="js/bootstrap-tooltip.js"></script>
        <script src="js/bootstrap-popover.js"></script>
        <script src="js/bootstrap-button.js"></script>
        <script src="js/bootstrap-collapse.js"></script>
        <script src="js/bootstrap-carousel.js"></script>
        <script src="js/bootstrap-typeahead.js"></script>
        <script src="js/pure_min.js"></script>
        <script src="js/jquery.inifintescroll.js"></script>
        
    </head>
    <body>
        <input type='hidden' id='current_page' />
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">Logbook</a>
                    <div class="btn-group pull-right">
                        <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="icon-user"></i> Username
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Profile</a></li>
                            <li class="divider"></li>
                            <li><a href="#">Sign Out</a></li>
                        </ul>
                    </div>
                    <div class="nav-collapse">
                        <ul class="nav">
                            <li class="active"><a href="index.html">Home</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                    <!-- The drop down menu -->
                    <ul class="nav pull-right">
                        <li class="divider-vertical"></li>
                        <li class="dropdown">
                            <a class="dropdown-toggle" href="#" data-toggle="dropdown">Sign In <strong class="caret"></strong></a>
                            <div class="dropdown-menu" style="padding: 15px; padding-bottom: 0px;">
                                <form action="[ACTION]" method="post" accept-charset="UTF-8">
                                    <input id="user_username" style="margin-bottom: 15px;" type="text" name="user[username]" size="30" />
                                    <input id="user_password" style="margin-bottom: 15px;" type="password" name="user[password]" size="30" />
                                    <input id="user_remember_me" style="float: left; margin-right: 10px;" type="checkbox" name="user[remember_me]" value="1" />
                                    <label class="string optional" for="user_remember_me"> Remember me</label>
                                    <input class="btn btn-primary" style="clear: left; width: 100%; height: 32px; font-size: 13px;" type="submit" name="commit" value="Sign In" />
                                </form>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <script>
            $(function() {
                // Setup drop down menu
                $('.dropdown-toggle').dropdown();

                // Fix input element click problem
                $('.dropdown input, .dropdown label').click(function(e) {
                    e.stopPropagation();
                });
            });
			
			//--------------------------------------------------
			//	Format the date and time
            var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            function printDate(unix) {
                var temp = new Date(unix);
                var dateStr = padStr(temp.getDate()) + ' ' +
                        monthNames[temp.getMonth()] + ' ' +
                        padStr(temp.getFullYear()) + ' ' +
                        padStr(temp.getHours()) + ':' +
                        padStr(temp.getMinutes()) + ':' +
                        padStr(temp.getSeconds());
                return dateStr;
            }

            function padStr(i) {
                return (i < 10) ? "0" + i : "" + i;
            }

        //----------------------------------------------------------------------
        //
        //              Directives
        //
        //----------------------------------------------------------------------

            var directives = {
                'div.log': {
                    'log <- context': {
                        '@class+': (function(arg) {
                            return (arg.pos % 2 === 0) ? ' even' : ' odd';
                        }),
                        '.createdDate': function(arg) {
                            return printDate(arg.item.createdDate);
                        },
                        '.owner': 'log.owner',
                        '.logbook': {'logbook <- log.logbooks': {
                                '.+': '#{logbook.name}, '
                            }},
                        '.tag': {'tag <- log.tags': {
                                '.+': '#{tag.name}, '
                            }},
                        '.property': {'property <- log.properties': {
                                '.+': '#{property.name}, '
                            }},
                        '.level': 'log.level',
                        '.description': 'log.description',
                    }
                },
            };
        
        //----------------------------------------------------------------------
        //
        //              Render function
        //
        //----------------------------------------------------------------------
        

            function render(pageNum) {
//                $.getJSON('http://berryman-win7.intranet.nscl.msu.edu:8080/Olog/resources/logs?limit=10', 'page=' + $('#page').val(), function(logs) {
                $.getJSON('jsonTest.json', function(logs) {
                    $('#target').append(rfn(logs));
                    //$('#target').html(rfn(logs));
                });
            }
        
        //----------------------------------------------------------------------
        //
        //              Document ready
        //
        //----------------------------------------------------------------------
        
            $(document).ready(function() {
                $('#page').val(1);
                $('#current_page').val(1);
                pageNum = 1;
                $.get('_logs.tmpl.html', function(templates) {
                    // Inject templates.
                    $('body').append(templates);
                    rfn = $('#logs_tmpl').compile(directives);
                    $.getJSON('jsonTest.json',function(logs) {
                                          $('#target').append(rfn(logs));
                    });
//                    render();
//                    $('#page').change(render);
                    $('div.well.row.log').hide();
                });
            });
        </script>
		<div class="container"><div id="target"></div></div>

<!--    <a id="next" href="mobile2.json"></a>

    <script>


        //----------------------------------------------------------------------
        //
        //              Infinite scroll with JSON
        //
        //----------------------------------------------------------------------

        var _renderItem = function(data) {
        return "<p>Title :" + data.title + "</p>";
        };


        $('#content').infinitescroll({

                navSelector : "a#next:last",
                nextSelector : "a#next:last",
                itemSelector : "#content p",
                debug	: true,
                dataType	: 'json',
                appendCallback	: false, // USE FOR PREPENDING
        }, function( response ) {
            var jsonData = response.results;
                        $theCntr = $("#content");
                        for(var i=0;i<jsonData.length;i++) {
                            var item = $(_renderItem(jsonData[i]));
                            $theCntr.append(item);
                        }
                });
    </script>-->
    </body>
</html>
